<script type="text/javascript"> 
  var usersTemplate;

  $(document).ready(function() {
    usersTemplate = new UsersTemplate();

    usersTemplate.init(<%= raw (@users.map{ |r| r.attributes }).to_json %>);
    usersTemplate.parmDeleteActionSelector("a[data-remote].delete");
    usersTemplate.parmTableSelector("#users-table-container");
    usersTemplate.parmEditFormSelector("#user_edit");
    usersTemplate.parmExtractingSelector("#user");

    usersTemplate.setEditAction();
  });
</script>

<h1>Пользователи</h1>

<div id="users-table-container" class="table-responsive standart-table-container">
<table id="users-table" class="table table-striped table-hover table-condensed table-bordered table-autosort">
  <thead>
    <tr>
      <th class="table-sortable:numeric table-sortable">Номер</th>
      <th class="table-sortable:default table-sortable">Логин</th>
      <th class="table-sortable:default table-sortable">Полное имя</th>
    </tr>
    <tr>
      <th></th>
      <th><input class="form-control" type="text" onkeyup="Table.filter(this,this)"></th>
      <th><input class="form-control" type="text" onkeyup="Table.filter(this,this)"></th>
    </tr>
  </thead>

  <tbody id ="requests">
    <% @users.each do |user| %>
      <tr id="<%= user.id %>" data-link="<%= edit_user_path(user) %>">
        <td><%= user.id %></td>
        <td><%= user.name %></td>
        <td><%= user.employee ? user.employee.name : nil %></td>
      </tr>
    <% end %>
  </tbody>
</table>

</div>

<div id="user_edit" class="displacer"></div> 