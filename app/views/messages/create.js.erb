function addNewMessage()
{
	if("<%= @message.errors.count %>" != 0)
	{
		var msg = $("#error-msg");
		showErrorMessage("Количество ошибок: <%= @message.errors.count %><br>" +
		                                        "Проверьте обязательные для ввода поля",
		                                        msg);

		var errors = <%= raw @message.errors.to_json %>;

		for(var key in errors) {
			if(errors[key].length > 0) {
				$('#newModal').find('#' + key).addClass('has-error');
			}
		}
	}
	else
	{
		var tr = $("<tr style='opacity: 0;' id='<%= @message.id %>'>" +
			'<td class="actions">' +
	          '<%= check_box_tag "for_destroy[]", @message.id, false %>' +
	        '</td>' +
			"<td><%= @message.id %></td>" +
			"<td><%= @message.name %></td>" +
			"<td><%= Request.request_types[@message.request_type.to_sym] %></td>" +
		"</tr>");

		messagesTemplate.insertRow(tr, <%= raw @message.attributes.to_json %>);

		var msg = $("#success-msg");
		showSuccessMessage("Тип сигнала успешно создан", msg);

		var form = $("#new_message");
    	form.find("#message_name").val('');

    	$('#newModal div').removeClass('has-error');

    	$('#newModal').modal('hide');
	}
}

addNewMessage();